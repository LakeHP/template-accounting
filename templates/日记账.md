.action{/*è·å–æ–‡æ¡£çš„åŸºæœ¬ä¿¡æ¯*/}
.action{$notebox :=" "}
.action{$docid:=.id}
.action{$getdocInfo := (queryBlocks "SELECT * FROM blocks WHERE id='?' and type='d' " $docid )}
.action{range $v:= $getdocInfo}
	.action{$notebox =$v.Box}	
.action{end}


.action{/*
newyear    		        æ˜å¹´ç¬¬ä¸€å¤©
newyearfirstday    		æ˜å¹´ç¬¬ä¸€å¤©
yearfirstday			ä»Šå¹´ç¬¬ä¸€å¤©
yearfirstdayweek		ä»Šå¹´ç¬¬ä¸€å¤©æ˜ŸæœŸå‡ 
data_26 ~ data_31		ä¸­é—´å˜é‡ æ¨æ–­æœ¬å¹´ç¬¬ä¸€å‘¨çš„æ˜ŸæœŸå¤©æ˜¯å‡ å·
yearfirstdayweeksunday	å€¼ æ¨æ–­æœ¬å¹´ç¬¬ä¸€å‘¨çš„æ˜ŸæœŸå¤©æ˜¯å‡ å·
*/}

.action{$newyear := (add (now | date "2006") 1)}
.action{$newyearfirstday := (cat ((add (now | date "2006") 1) ) "01 01") | replace " " "-"}
.action{$yearfirstday := (cat (now | date "2006") "01 01") | replace " " "-"}
.action{$yearfirstdayweek := add (mod (div ((toDate "2006-01-02" "2050-03-13").Sub (toDate "2006-01-02" $yearfirstday)).Hours 24) 7) 1}
.action{$dayleft := (div ((toDate "2006-01-02" $newyearfirstday).Sub now).Hours 24)}
.action{$week := add (mod (div ((toDate "2006-01-02" "2050-03-13").Sub now).Hours 24) 7) 1}


.action{$data_26 := (cat ((sub (now | date "2006") 1) ) "12 26") | replace " " "-"}
.action{$data_27 := (cat ((sub (now | date "2006") 1) ) "12 27") | replace " " "-"}
.action{$data_28 := (cat ((sub (now | date "2006") 1) ) "12 28") | replace " " "-"}
.action{$data_29 := (cat ((sub (now | date "2006") 1) ) "12 29") | replace " " "-"}
.action{$data_30 := (cat ((sub (now | date "2006") 1) ) "12 30") | replace " " "-"}
.action{$data_31 := (cat ((sub (now | date "2006") 1) ) "12 31") | replace " " "-"}

.action{$yearfirstdayweeksunday := (last (slice (list $yearfirstday $data_26 $data_27 $data_28 $data_29 $data_30 $data_31) 0 $yearfirstdayweek ))}



.action{/*è·å–å½“å‰æ˜¯ç¬¬å‡ å‘¨*/}
	.action{$ng_duration := (toDate "2006-01-02" $yearfirstdayweeksunday).Sub now}
	.action{$weekhours:=mul 7 24}
	.action{$duration:=sub 0 $ng_duration.Hours }
	.action{$weeks := add (div (div (now.Sub (toDate "2006-01-02" $yearfirstdayweeksunday)).Hours 24) 7) 1}
	.action{$today:= (now | date "2006-01")}
	.action{$weekResult:= (list $today "Week" $weeks| join " ")}


.action{$dayleft := (div ((toDate "2006-01-02" $newyearfirstday).Sub now).Hours 24)}
.action{$week := add (mod (div ((toDate "2006-01-02" "2050-03-13").Sub now).Hours 24) 7) 1}

{{{col
{{{row
ğŸ• åˆ›å»ºæ—¶é—´ï¼š.action{now | date "2006-01-02 15:04"} .action{last (slice (list "æ˜ŸæœŸå…­" "æ˜ŸæœŸäº”" "æ˜ŸæœŸå››" "æ˜ŸæœŸä¸‰" "æ˜ŸæœŸäºŒ" "æ˜ŸæœŸä¸€" "æ˜ŸæœŸå¤©") 0 $week )}
}}}
{{{row
è·ç¦» `.action{$newyear}` è¿˜å‰© `.action{$dayleft}` å¤©ï¼ŒåŠ æ²¹ï¼
}}}
{: style="color: var(--b3-card-info-color); background-color: var(--b3-card-info-background);"}
}}}


{{{row

## ä»Šæ—¥è®°è´¦
{: name=".action{now | date "2006-01-02"}"}
{{{col

{{{row
### ğŸ§¥è¡£
---

{{{col
{{{row
ğŸª™
}}}

{{{row
{: alias=".action{now | date "2006-01-02"}" name="è®°è´¦" memo="è¡£" custom-accounting="accounting-.action{now | date "2006-01"}"}
}}}

}}}

}}}

{{{row
### ğŸ«’é£Ÿ
---

{{{col
{{{row
ğŸª™
}}}

{{{row
{: alias=".action{now | date "2006-01-02"}" name="è®°è´¦" memo="é£Ÿ" custom-accounting="accounting-.action{now | date "2006-01"}"}
}}}

}}}

}}}

{{{row
### ğŸ ä½
---

{{{col
{{{row
ğŸª™
}}}

{{{row
{: alias=".action{now | date "2006-01-02"}" name="è®°è´¦" memo="ä½" custom-accounting="accounting-.action{now | date "2006-01"}"}
}}}

}}}

}}}

{{{row
### ğŸš‡è¡Œ
---

{{{col
{{{row
ğŸª™
}}}

{{{row
{: alias=".action{now | date "2006-01-02"}" name="è®°è´¦" memo="è¡Œ" custom-accounting="accounting-.action{now | date "2006-01"}"}
}}}

}}}

}}}


}}}
{: name="" fold="0"}
.action{/*sä¸Šé¢è®¾ç½®å‘½åä¸ºç©ºå’Œä¸æŠ˜å ,ä¸ºäº†é˜²æ­¢è¶…çº§å—å†…éƒ¨çš„å±æ€§é”™ä½,è¢«è¶…çº§å—è·å–*/}
}}}





{{{row
## ğŸ’°ä»Šæ—¥
{: alias=".action{now | date "2006-01"} Week .action{$weeks}" name=".action{now | date "2006-01-02"}"}

```sql
SELECT SUM(markdown) AS ä»Šæ—¥è®°è´¦ FROM (select * from blocks where name="è®°è´¦" and alias=".action{now | date "2006-01-02"}")
```
{: custom-type="query-code"}

<iframe src="/widgets/Query" data-src="/widgets/Query" data-subtype="widget" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="width: 374px; height: 37px; border: none; background-color: transparent;"></iframe>
{: custom-query-fields="["type", "content", "hpath", "memo", "box"]" custom-type="query-widget" custom-query-limit=""len"" custom-query-maxrow="2" custom-query-maxlen="20"}



}}}
{: name="" fold="0"}
.action{/*sä¸Šé¢è®¾ç½®å‘½åä¸ºç©ºå’Œä¸æŠ˜å ,ä¸ºäº†é˜²æ­¢è¶…çº§å—å†…éƒ¨çš„å±æ€§é”™ä½,è¢«è¶…çº§å—è·å–*/}



